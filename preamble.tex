\documentclass[14pt, a4paper]{extarticle}

\usepackage{listings}

\usepackage[paper=A4]{typearea}
\usepackage{lipsum}

\usepackage{caption}
\usepackage{graphicx}
\graphicspath{{./images/}}
\DeclareGraphicsExtensions{.jpg,.png}
\usepackage{csvsimple}

\usepackage[english,russian]{babel}

\usepackage{fontspec} 
\usepackage{unicode-math}
\defaultfontfeatures{Ligatures={TeX},Renderer=Basic}
\setmainfont[Ligatures={TeX,Historic}]{Times New Roman}
\setmonofont{Courier New}
\setmathfont{XITS Math}
\newfontfamily\cyrillicfonttt[Script=Cyrillic]{Courier New}
\babelfont{sf}{Droid Sans}
\numberwithin{equation}{section}

\usepackage{chngcntr}

\usepackage{xcolor}

\usepackage{array}
\newcommand\ChangeRT[1]{\noalign{\hrule height #1}}

\usepackage{tabularx}
\newcolumntype{s}{>{\raggedright\arraybackslash}X}
%\renewcommand{\tabularxcolumn}[1]{m{#1}} % Вертикальное центрирование текста

\usepackage{indentfirst} %отступ первой строки первого абзаца
\linespread{1.5}

\setlength{\footskip}{1cm}
\usepackage{geometry}
\geometry{left=3cm}
\geometry{right=1cm}
\geometry{top=2cm}
\geometry{bottom=2cm}

\setlength{\parindent}{1.25cm}

\usepackage{enumitem}
\setlist{left=\parindent, labelsep=1cm, itemsep=0pt, topsep=0pt}

\usepackage[final]{pdfpages}

\usepackage{titlesec} % оформление заголовков

\titleformat{\section}[block]
	{\bfseries\fontsize{18pt}{21.6pt}\selectfont}
        {\thesection}
        {1em}{}
\titleformat{name=\section,numberless}[block]
	{\centering\bfseries\fontsize{18pt}{21.6pt}\selectfont}
        {}
        {0em}{}{}
\titlespacing{\section}
 {\parindent}% space at the left
 {0em}% space before
 {10mm}% space after
\titleformat{\subsection}[block]
	{\bfseries\hspace{\parindent}\fontsize{16pt}{19.2pt}\selectfont}
        {\thesubsection}
        {1em}{}

% Отображать только заголовки первого уровня
%\setcounter{tocdepth}{1}

\usepackage{etoolbox}

\usepackage{nameref}

\usepackage{xurl}
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black,
    breaklinks=true
}
\urlstyle{same}
       
\usepackage{float}
\usepackage{graphicx,kantlipsum,setspace}

\usepackage{newfloat}
\DeclareCaptionType[name=Листинг, placement=htbp]{listing}

\usepackage{fancyvrb}

\DeclareCaptionLabelSeparator{emdash}{\;\textemdash\;}
\captionsetup[figure]{name={Рисунок}, 
                      labelsep=emdash, 
                      justification=centering, 
                      position=above, 
                      singlelinecheck=off, 
                      font={singlespacing, small, bf},
                      labelfont=bf, 
                      skip=6pt}

\captionsetup[table]{name={Таблица}, 
                     labelsep=emdash, 
                     justification=raggedright, 
                     position=top, 
                     singlelinecheck=off, 
                     font={singlespacing, small, it}, 
                     labelfont=it, 
                     skip=0pt, 
                     margin=0cm}

\captionsetup[lstlisting]{labelsep=emdash, 
                          justification=raggedright, 
                          position=top, 
                          singlelinecheck=off, 
                          font={singlespacing, small, it}, 
                          labelfont=it, 
                          skip=0pt, 
                          margin=0cm}


% Нумерация по разделам
\counterwithin{figure}{section}
\counterwithin{table}{section}
\counterwithin{listing}{section}

\usepackage{ragged2e}
\usepackage{microtype}

\justifying
\tolerance=500
\hyphenpenalty=10000 % отключение переноса
\emergencystretch=3em

\usepackage{setspace}

\usepackage{multirow}

\usepackage[
citestyle=gost-numeric,
style=gost-numeric, 
blockpunct=emdash,
backend=biber,
sorting=none
]{biblatex}

\defcounter{biburlnumpenalty}{3000}
\defcounter{biburlucpenalty}{6000}
\defcounter{biburllcpenalty}{9000}

\DeclareFieldFormat{url}{Режим доступа: #1}
\DeclareFieldFormat{urldate}{(Дата обращения: #1)}
\renewcommand*{\entrysetpunct}{\par\nopunct\!\!}


\defbibheading{bibliography}[\bibname]{%
  \section*{\centering #1}%
  \markboth{#1}{#1}}

\addbibresource{misc/thesis5.bib}

\usepackage{pdflscape}
\usepackage{everypage}

\newcommand{\Lpagenumber}{\ifdim\textwidth=\linewidth\else\bgroup
  \dimendef\margin=0 %use \margin instead of \dimen0
  \ifodd\value{page}\margin=\oddsidemargin
  \else\margin=\evensidemargin
  \fi
  \raisebox{\dimexpr-\topmargin-\headheight-\headsep-0.5\linewidth}[0pt][0pt]{%
    \rlap{\hspace{\dimexpr-\margin+\textheight+\footskip}%
    \llap{\rotatebox{90}{\thepage}}}}%
\egroup\fi}
\AddEverypageHook{\Lpagenumber}%

\usepackage{tocloft}
\setlength{\cftsecnumwidth}{0pt}
\setlength{\cftsecindent}{0pt}% Remove indent for \section
\setlength{\cftsubsecindent}{0pt}% Remove indent for \subsection
\setlength{\cftsubsubsecindent}{0pt}% Remove indent for \subsubsection
\setlength{\cftbeforesecskip}{0pt}% Change spacing between sections
\renewcommand{\cftsecaftersnumb}{\hspace{1.5em}}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftdotsep}{1.25}
\renewcommand{\cftsecfont}{\normalfont}
\renewcommand{\cftsecpagefont}{\normalfont}
\renewcommand{\cfttoctitlefont}{\hfil \bfseries \large}

% Поддержка листингов
\usepackage{listings}
\lstdefinestyle{gost}{
    basicstyle=\ttfamily\fontsize{10pt}{10pt}\linespread{1}\selectfont,
    breakatwhitespace=false,
    breaklines=true,
    keepspaces=true,
    showspaces=false,          
    showstringspaces=false,
    frame=single
}
\lstset{style=gost}

\usepackage{lipsum} 

\begin{document}

\counterwithin{lstlisting}{section}

\pretocmd{\section}{\newpage}{}{}

\def\contentsname{СОДЕРЖАНИЕ}

\pagenumbering{gobble}
\begin{titlepage}
\includepdf[pages=-]{misc/Gostev}
\end{titlepage}
\tableofcontents

\section*{ВВЕДЕНИЕ}
\pagenumbering{arabic}
\setcounter{page}{4}
%%% start Актуальность темы
В современном мире, где информационные техно

\section{АНАЛИЗ ДАННЫХ ПОСТАВЛЕННОЙ ЗАДАЧИ}


Предприятие, для которого проектируется сеть, представляет собой сложную структуру,
которая включает в себя различные единицы и отделы. Она состоит из нескольких зданий 
и локаций, каждая из которых имеет свои специфические требования к сетевому оборудованию 
и связи. При этом предполагается, что на каждое рабочее место необходимо обеспечить пропускную 
способность в 100 Мбит/с, что обусловлено стандартами отрасли и требованиями к качеству обслуживания. 
Важно отметить, что руководителям и заместителям руководителей нужно выделить пропускную способность в 
1 Гбит/с, кроме руководителей точек присутствия и складов.

Главный штаб предприятия обслуживает 200 человек, в его руководство входит директор предприятия, а 
также коммерческий отдел, состоящий из коммерческих директоров. Следующим элементом структуры 
предприятия являются филиалы, их три, и в каждом из них работает 70 сотрудников. 
Склады предприятия представлены четырьмя объектами, на каждом из которых работают 30 сотрудников. 
Есть 25 точек присутствия и каждая обслуживает 6 сотрудников.

\begin{table}[H]
\centering
\small
\caption{Структура предприятия в главном здании}
\begin{tabular}{|m{5cm}|m{3cm}|m{3cm}|}
\hline
\textbf{Название отдела} & \textbf{Количество людей} & \textbf{Пропускная способность, МБит/с} \\
\hline
Руководство предприятия & 1 & 1000 \\
\hline
Коммерческий отдел & 3 & 100 \\
\hline
Бухгалтерия & 11 & 100 \\
\hline
Отдел кадров & 20 & 100 \\
\hline
Отдел закупок & 20 & 100 \\
\hline
Отдел продаж & 55 & 100 \\
\hline
Административно-хозяйственная служба & 15 & 100 \\
\hline
ИТ-департамент & 40 & 100 \\
\hline
Профильные отделы & 35 & 100 \\
\hline
\end{tabular}
\label{table:1:mainDepStructure}
\end{table}


%Текст в маркированном списке начинается с маленькой (строчной) буквы, а заканчивается — точкой 
%с запятой (последний пункт в списке заканчивается точкой). 
%Текст в нумерованном списке должен начинаться с прописной буквы и заканчиваться точкой (рис. 2.1-2.3). 
\section{Пример Нумерованного Списка}

Вот пример нумерованного списка с указанными настройками:

\begin{enumerate}
    \item Первый пункт списка.
    \item Второй пункт с немного большим текстом для иллюстрации обтекания строки и её выравнивания по отношению к первой строке.
    \item Третий пункт в списке.
    \item Четвертый и другой пункт для проверки выравнивания и расстояния.
\end{enumerate} 

\section{Пример Маркированного Списка}
Вот пример маркированного списка с указанными настройками:

\begin{itemize}
    \item первый пункт списка;
    \item второй пункт с немного большим текстом для иллюстрации обтекания строки и её выравнивания по отношению к первой строке;
    \item третий пункт в списке;
    \item четвертый и другой пункт для проверки выравнивания и расстояния.
\end{itemize}

\section[ПЛАНИРОВАНИЕ АДРЕСАЦИИ И МАРШРУТИЗАЦИИ]{ПЛАНИРОВАНИЕ АДРЕСАЦИИ И \\ МАРШРУТИЗАЦИИ}
На основе данных о структуре предприятия,
необходимо настроить IP-адресацию в каждом элементе
предприятия. Для обеспечения рабочих мест IP-адресами, достаточно взять частные адреса класса "C".


Любой отдел будет доступен из любого другого.
Каждый элемент предприятия содержит относительно небольшое количество конечных узлов, 
а сетевая топология меняется медленно. В контексте этих условий, применение 
статической маршрутизации представляется наиболее подходящим и эффективным подходом, 
по сравнению с динамической маршрутизацией.\cite{habr-routing}


\begin{landscape}
\begin{table}[H]
\centering
\small
\caption{Планирование IP-адресации для главного здания апппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппппп}
\begin{tabular}{|m{3cm}|m{2cm}|m{2cm}|m{2cm}|m{2.3cm}|m{3cm}|m{2.2cm}|m{2.6cm}|m{3.6cm}|}
\hline
\textbf{Отдел} & \textbf{Требуемый размер} & \textbf{Выделено адресов} & \textbf{Остаток свободных адресов} & \textbf{IP адрес подсети} & \textbf{Маска подсети} & \textbf{Префикс маски} & \textbf{Диапазон адресов} & \textbf{Широковещание} \\
\hline
Отдел продаж & 55+2 & 64 & 7 & 192.168.0.0 & 255.255.255.192 & /26 & 192.168.0.1 - 192.168.0.62 & 192.168.0.63 \\
\hline
ИТ-департамент & 40+2 & 64 & 22 & 192.168.0.64 & 255.255.255.192 & /26 & 192.168.0.65 - 192.168.0.126 & 192.168.0.127 \\
\hline
Профильные отделы & 35+2 & 64 & 27 & 192.168.0.128 & 255.255.255.192 & /26 & 192.168.0.129 - 192.168.0.190 & 192.168.0.191 \\
\hline
Отдел кадров & 20+2 & 32 & 10 & 192.168.0.192 & 255.255.255.224 & /27 & 192.168.0.193 - 192.168.0.222 & 192.168.0.223 \\
\hline
Отдела закупок & 20+2 & 32 & 10 & 192.168.0.224 & 255.255.255.224 & /27 & 192.168.0.225 - 192.168.0.254 & 192.168.0.255 \\
\hline
АХО & 15+2 & 32 & 15 & 192.168.1.0 & 255.255.255.224 & /27 & 192.168.1.1 - 192.168.1.30 & 192.168.1.31 \\
\hline
Бухгалтерия & 11+2 & 16 & 3 & 192.168.1.32 & 255.255.255.240 & /28 & 192.168.1.33 - 192.168.1.46 & 192.168.1.47 \\
\hline
Коммерческий отдел & 3+2 & 8 & 3 & 192.168.1.48 & 255.255.255.248 & /29 & 192.168.1.49 - 192.168.1.54 & 192.168.1.55 \\
\hline
Руководство предприятия & 1+2 & 8 & 3 & 192.168.1.56 & 255.255.255.248 & /29 & 192.168.1.57 - 192.168.1.62 & 192.168.1.63 \\
\hline
\end{tabular}
\label{table:2:mainDepIPplanning}
\end{table}
\end{landscape}
\newpage


\section{НАСТРОЙКА И ТЕСТИРОВАНИЕ СЕТИ}
В данном пункте выполняется настройка и тестирование сети передачи
данных, основанной на ранее разработанном прототипе. Процесс реализации
сети сосредоточен на самой большой площадке предприятия, которая является
штаб-квартирой.


\section{lstinputlisting command}
\lstinputlisting[caption={Конфигурация SL2-10fdsgfggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggg
\label{list:sl2_10}}, firstline=1, lastline=43]{misc/config1.txt}
\newpage

\lstinputlisting[caption={Next}, firstline=51]{misc/config1.txt}

\section{begin lstlisting command}
\ref{list:sl2_99}
\begin{lstlisting}[caption={Конфигурация SL2-9 ппппппппппппппппппппппппппппппп
    пппппппппппппппппппппппппппппппппппппппппппппппп\label{list:sl2_99}}]
sysname Huawei
#
vlan batch 11 to 19
#
stp mode stp
#
cluster enable
ntdp enable
ndp enable
#
drop illegal-mac alarm
#
diffserv domain default
#
drop-profile default
#
aaa 
authentication-scheme default
authorization-scheme default
accounting-scheme default
domain default 
domain default_admin 
local-user admin password simple admin
local-user admin service-type http
#
interface Vlanif1
#
interface MEth0/0/1
#
interface GigabitEthernet0/0/1
port link-type access
port default vlan 19
#
interface GigabitEthernet0/0/2
port link-type access
port default vlan 15
#
interface GigabitEthernet0/0/3
port link-type trunk
port trunk allow-pass vlan 11 to 19
#
interface GigabitEthernet0/0/4
port link-type trunk
port trunk allow-pass vlan 11 to 19
#
interface GigabitEthernet0/0/5
#
interface GigabitEthernet0/0/6
#
interface GigabitEthernet0/0/7
#
interface GigabitEthernet0/0/8
#
\end{lstlisting}

\begin{equation}
    E=mc^2 \label{eq:energy}
    \end{equation}

\section{Формулы}
Формулы
Mbit \(\text{Mbit}\)
МБит \(\text{МБит}\)

{\sffamily
Mbit \(\mathrm{Mbit}\)
МБит \(\text{МБит}\)
}

\begin{equation}
p=100 \times 100 \;\frac{\text{Мбит}}{\text{с}} \times 40 \% + 20 \;\text{узлов} \times 1000 \;\frac{\text{Мбит}}{\text{с}}\times 40 \% = 24000\;\frac{\text{Мбит}}{\text{с}}
\end{equation}



\section*{ЗАКЛЮЧЕНИЕ} 
\addcontentsline{toc}{section}{ЗАКЛЮЧЕНИЕ}
бла-бла-бла.

\begingroup
\let\itshape\upshape
\sloppy
%\raggedright
%\nocite{*} print everything
\printbibliography[title=СПИСОК ИСПОЛЬЗУЕМЫХ ИСТОЧНИКОВ]\addcontentsline{toc}{section}{СПИСОК ИСПОЛЬЗУЕМЫХ ИСТОЧНИКОВ}
\endgroup

\section*{ПРИЛОЖЕНИЯ}
\addcontentsline{toc}{section}{ПРИЛОЖЕНИЯ}
\begin{raggedright}
Приложение А --- Тестирование работоспособности сети.
\end{raggedright}


\appendix
\addtocontents{toc}{\protect\setcounter{tocdepth}{0}}
\titleformat{name=\section}[display]
	{\newpage\normalfont\centering}
        {\bfseries Приложение\ \thesection}{0em}{}{}
%\renewcommand{\section}{\Asbuk{section}}
\section{Тестирование работоспособности сети}

Для проверки адресации предлагается отправить эхо-запросы от компьютера руководителя к остальным отделам, а также к маршрутизатору.

На Рисунке\;\ref{fig:first}представлена проверка эхо-запросов из руководства к отделам.
\begin{figure}[H]
\centering
\includegraphics[scale=0.7]{misc/first}
\caption{Эхо-запросы к отделам из руководства ппппппппппппппппппппппппппппппппппппппппппппппппппппппппп\label{fig:first}}
\end{figure}



\end{document}
